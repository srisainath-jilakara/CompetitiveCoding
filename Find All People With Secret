class Solution {
    public List<Integer> findAllPeople(int n, int[][] meetings, int firstPerson) {
        HashSet<Integer> knowSecret = new HashSet<>();
        knowSecret.add(0);
        knowSecret.add(firstPerson);
        Arrays.sort(meetings,(a,b)->Integer.compare(a[2],b[2]));
        int i = 0;
        while(i<meetings.length){
            int currentTime = meetings[i][2];
            Map<Integer,List<Integer>> graph = new HashMap<>();
            HashSet<Integer> peopleAtCurTime = new HashSet<>();

            while(i<meetings.length && meetings[i][2] == currentTime) {
                int p1 = meetings[i][0];
                int p2 = meetings[i][1];
                graph.putIfAbsent(p1,new ArrayList<>());
                graph.putIfAbsent(p2,new ArrayList<>());
                graph.get(p1).add(p2);
                graph.get(p2).add(p1);
                peopleAtCurTime.add(p1);
                peopleAtCurTime.add(p2);
                i++;
            }
            HashSet<Integer> visited = new HashSet<>(); 
            Queue<Integer> queue = new LinkedList<>();
            for(int p: peopleAtCurTime) {
                if(knowSecret.contains(p)){
                    queue.add(p);
                    visited.add(p);
                }
            }

            while(!queue.isEmpty()) {
                int p = queue.poll();
                if(graph.get(p)!=null){
                    for(int neigh: graph.get(p)) {
                        if(!visited.contains(neigh)) {
                            queue.add(neigh);
                            visited.add(neigh);
                        }
                    }
                }
            }

            knowSecret.addAll(visited);
        }


        return new ArrayList<>(knowSecret);
    }
}
